<!doctype html>
<html lang="ko" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-java/script-plugin">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">스크립트 플러그인 | WhaTap</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.whatap.io/java/script-plugin"><meta data-rh="true" name="docusaurus_locale" content="ko"><meta data-rh="true" name="docsearch:language" content="ko"><meta data-rh="true" name="keywords" content="WhaTap, 와탭, 매뉴얼, 사용법, WhaTap 사용법, WhaTap 매뉴얼, 기술 문서, APM, 애플리케이션 모니터링, 로그 모니터링, 쿠버네티스 모니터링, 서버 모니터링, 데이터베이스 모니터링, URL 모니터링, 클라우드 모니터링, Application Monitoring, Log Monitoring, Kubernetes Monitoring, Server Monitoring, Database Monitoring, URL Monitoring, Cloud Monitoring, Manual, User Guide, Docs, WhaTap Manual, WhaTap Docs, WhaTap Documents"><meta data-rh="true" name="naver-site-verification" content="0c21fc5664a467108fb762ade47a3f81ee9b88ed"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="스크립트 플러그인 | WhaTap"><meta data-rh="true" name="description" content="Java 에이전트에서 제공하는 플러그인을 활용해 다양한 일을 할 수 있습니다."><meta data-rh="true" property="og:description" content="Java 에이전트에서 제공하는 플러그인을 활용해 다양한 일을 할 수 있습니다."><link data-rh="true" rel="icon" href="/img/whatap-favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.whatap.io/java/script-plugin"><link data-rh="true" rel="alternate" href="https://docs.whatap.io/java/script-plugin" hreflang="ko"><link data-rh="true" rel="alternate" href="https://docs.whatap.io/java/script-plugin" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-E46TQ5VSCT"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-E46TQ5VSCT",{anonymize_ip:!0})</script>
<link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-WJSZDJR",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script>



<script src="https://app.happyreact.com/widget/reactions.js" async></script><link rel="stylesheet" href="/assets/css/styles.788e1a8c.css">
<link rel="preload" href="/assets/js/runtime~main.5f3bfd9f.js" as="script">
<link rel="preload" href="/assets/js/main.70a14a28.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script>



<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WJSZDJR" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__docusaurus">
<div role="region" aria-label="본문으로 건너뛰기"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">본문으로 건너뛰기</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/whatap-docs-logo.svg" alt="WhaTap Docs" class="themedImage_ToTc themedImage--light_HNdA" height="28" width="152"><img src="/img/whatap-docs-logo.svg" alt="WhaTap Docs" class="themedImage_ToTc themedImage--dark_i4oU" height="28" width="152"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/getting-started/whatap-overview">시작하기</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">상품별 문서 바로가기</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/java/introduction">Java</a></li><li><a class="dropdown__link" href="/php/introduction">PHP</a></li><li><a class="dropdown__link" href="/nodejs/introduction">Node.js</a></li><li><a class="dropdown__link" href="/python/introduction">Python</a></li><li><a class="dropdown__link" href="/dotnet/introduction">.NET</a></li><li><a class="dropdown__link" href="/golang/introduction">Golang</a></li><li><a class="dropdown__link" href="/server/introduction">Server</a></li><li><a class="dropdown__link" href="/kubernetes/introduction">Kubernetes</a></li><li><a class="dropdown__link" href="/postgresql/monitoring-intro">PostgreSQL</a></li><li><a class="dropdown__link" href="/oracle/monitoring-intro">Oracle</a></li><li><a class="dropdown__link" href="/mysql/monitoring-intro">MySQL</a></li><li><a class="dropdown__link" href="/mssql/monitoring-intro">MS SQL Server</a></li><li><a class="dropdown__link" href="/tibero/monitoring-intro">Tibero</a></li><li><a class="dropdown__link" href="/cubrid/monitoring-intro">CUBRID</a></li><li><a class="dropdown__link" href="/altibase/monitoring-intro">Altibase</a></li><li><a class="dropdown__link" href="/redis/monitoring-intro">Redis</a></li><li><a class="dropdown__link" href="/mongodb/monitoring-intro">MongoDB</a></li><li><a class="dropdown__link" href="/url/url-intro">URL</a></li><li><a class="dropdown__link narrow" href="/amazon-cloudwatch/install-agent">Amazon CloudWatch</a></li><li><a class="dropdown__link" href="/amazon-ecs/introduction">Amazon ECS</a></li><li><a class="dropdown__link" href="/azure/install-agent">Azure Monitor</a></li><li><a class="dropdown__link narrow" href="/ncloud/install-agent">Naver Cloud Monitoring</a></li><li><a class="dropdown__link narrow" href="/oracle-cloud/install-agent">Oracle Cloud Monitor</a></li><li><a class="dropdown__link" href="/log/introduction">Log</a></li><li><a class="dropdown__link" href="/extensions">Extensions</a></li></ul></div><a aria-current="page" class="navbar__item navbar__link hidden navbar__link--active" href="/java/introduction">Java 모니터링</a><a class="navbar__item navbar__link hidden" href="/php/introduction">PHP 모니터링</a><a class="navbar__item navbar__link hidden" href="/nodejs/introduction">Node.js 모니터링</a><a class="navbar__item navbar__link hidden" href="/python/introduction">Python 모니터링</a><a class="navbar__item navbar__link hidden" href="/dotnet/introduction">.NET 모니터링</a><a class="navbar__item navbar__link hidden" href="/golang/introduction">Golang 모니터링</a><a class="navbar__item navbar__link hidden" href="/server/introduction">Server 모니터링</a><a class="navbar__item navbar__link hidden" href="/kubernetes/introduction">Kubernetes 모니터링</a><a class="navbar__item navbar__link hidden" href="/postgresql/monitoring-intro">PostgreSQL 모니터링</a><a class="navbar__item navbar__link hidden" href="/oracle/monitoring-intro">Oracle 모니터링</a><a class="navbar__item navbar__link hidden" href="/mysql/monitoring-intro">MySQL 모니터링</a><a class="navbar__item navbar__link hidden" href="/mysql-rds/monitoring-intro">MySQL RDS 모니터링</a><a class="navbar__item navbar__link hidden" href="/mssql/monitoring-intro">MS SQL Server 모니터링</a><a class="navbar__item navbar__link hidden" href="/tibero/monitoring-intro">Tibero 모니터링</a><a class="navbar__item navbar__link hidden" href="/cubrid/monitoring-intro">CUBRID 모니터링</a><a class="navbar__item navbar__link hidden" href="/altibase/monitoring-intro">Altibase 모니터링</a><a class="navbar__item navbar__link hidden" href="/redis/monitoring-intro">Redis 모니터링</a><a class="navbar__item navbar__link hidden" href="/mongodb/monitoring-intro">MongoDB 모니터링</a><a class="navbar__item navbar__link hidden" href="/url/url-intro">URL 모니터링</a><a class="navbar__item navbar__link hidden" href="/amazon-cloudwatch/install-agent">Amazon CloudWatch</a><a class="navbar__item navbar__link hidden" href="/amazon-ecs/introduction">Amazon ECS</a><a class="navbar__item navbar__link hidden" href="/azure/install-agent">Azure Monitor</a><a class="navbar__item navbar__link hidden" href="/ncloud/install-agent">Naver Cloud Monitoring</a><a class="navbar__item navbar__link hidden" href="/oracle-cloud/install-agent">Oracle Cloud Monitor</a><a class="navbar__item navbar__link hidden" href="/log/introduction">Log 모니터링</a><a class="navbar__item navbar__link hidden" href="/rum/introduction">브라우저 모니터링(RUM)</a><a class="navbar__item navbar__link hidden" href="/extensions">확장 도구</a><a class="navbar__item navbar__link" href="/manage">관리 기능</a><a class="navbar__item navbar__link" href="/reference">참조 문서</a><a class="navbar__item navbar__link" href="/release-notes/">릴리스 노트</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="어두운 모드와 밝은 모드 전환하기 (현재 밝은 모드)" aria-label="어두운 모드와 밝은 모드 전환하기 (현재 밝은 모드)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" fill="none" class="lightToggleIcon_pyhR"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M10.9901 0H13.0099V4.06189C15.2205 4.33486 17.1538 5.49222 18.4373 7.16513L21.9901 5.13397L23 6.86603L19.4486 8.89635C19.8546 9.8507 20.0791 10.8994 20.0791 12C20.0791 13.1006 19.8546 14.1493 19.4486 15.1036L23 17.134L21.9901 18.866L18.4373 16.8349C17.1538 18.5078 15.2205 19.6651 13.0099 19.9381V24H10.9901V19.9381C8.77946 19.6651 6.84617 18.5078 5.56273 16.8349L2.00989 18.866L1 17.134L4.5514 15.1036C4.14535 14.1493 3.9209 13.1006 3.9209 12C3.9209 10.8994 4.14535 9.8507 4.5514 8.89635L1 6.86603L2.00989 5.13397L5.56273 7.16513C6.84617 5.49222 8.77946 4.33486 10.9901 4.06189V0ZM5.94068 12C5.94068 8.68629 8.65353 6 12 6C15.3465 6 18.0593 8.68629 18.0593 12C18.0593 15.3137 15.3465 18 12 18C8.65353 18 5.94068 15.3137 5.94068 12Z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M5.05011 4.409C6.46482 2.9943 8.14585 2.02264 9.90788 1.5C8.84446 5.08024 9.63565 8.99454 12.3303 11.6892C15.025 14.3839 18.9393 15.1751 22.5191 14.1129C21.9969 15.8737 21.0253 17.5548 19.6106 18.9695C15.322 23.2581 8.58587 23.4752 4.56511 19.4545C0.544352 15.4337 0.761495 8.69762 5.05011 4.409ZM7.26586 5.19608C6.97785 5.42391 6.70099 5.67022 6.43684 5.93437C2.99054 9.38066 2.80435 14.782 6.02096 17.9986C9.23756 21.2152 14.6389 21.029 18.0852 17.5827C18.4373 17.2307 18.7577 16.856 19.0448 16.4625C15.9881 16.4646 13.0552 15.3261 10.8743 13.1452C8.77411 11.045 7.6407 8.24751 7.56194 5.31354L7.55754 4.97444L7.26586 5.19608ZM17.3387 2.30478H19.3979V4.36394H21.4571V6.4231H19.3979V8.48226H17.3387V6.4231H15.2795V4.36394H17.3387V2.30478Z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="검색" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="맨 위로 스크롤하기" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_mhZE"><div class="hold-menu"><ul><li><a href="/" class="home">WhaTap Docs</a></li><li><a href="https://www.whatap.io" target="_blank" class="ext">와탭 홈페이지 바로가기</a></li></ul></div><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" href="/java/introduction">JAVA 모니터링</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/java/supported-spec">지원 환경</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/java/install-agent">에이전트 설치</a><button aria-label="접을 수 있는 사이드바 분류 &#x27;에이전트 설치&#x27; 접기(펼치기)" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/java/software-proxy">소프트웨어 프록시</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/java/install-check">설치 점검 사항</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/java/agent-troubleshooting">설치 문제 해결</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/java/set-agent">설정하기</a><button aria-label="접을 수 있는 사이드바 분류 &#x27;설정하기&#x27; 접기(펼치기)" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/java/agent-name">에이전트 이름 식별</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/java/agent-control-function">에이전트 기능 제어</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/java/agent-usage">CPU/메모리/디스크 사용량 수집</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/java/agent-network">에이전트 통신 설정</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/java/agent-performance">에이전트 성능</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/java/agent-log">에이전트 로그 설정</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/java/agent-gc-log">GC 로그 모니터링</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/java/agent-transaction">트랜잭션</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/java/agent-dbsql">DB, SQL</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/java/agent-httpcapicall">HTTPC, API Call</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/java/script-plugin">에이전트 플러그인</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/java/script-plugin">스크립트 플러그인</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/java/weaving-plugin">위빙 플러그인</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/java/agent-number-of-user">사용자 수</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/java/agent-load-amount">부하량 제어</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/java/agent-notification">에이전트 알림</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/java/agent-apdex">Apdex</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/java/agent-static">통계</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/java/agent-toplogy">토폴로지 맵</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/java/agent-additional-option">부가 기능</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/java/update-agent">관리하기</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" tabindex="0" href="/java/learn-apm-main-menu">주요 메뉴 알아보기</a><button aria-label="접을 수 있는 사이드바 분류 &#x27;주요 메뉴 알아보기&#x27; 접기(펼치기)" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/java/dashboard-intro">대시보드</a><button aria-label="접을 수 있는 사이드바 분류 &#x27;대시보드&#x27; 접기(펼치기)" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/java/flex-board">Flex 보드</a><button aria-label="접을 수 있는 사이드바 분류 &#x27;Flex 보드&#x27; 접기(펼치기)" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/java/topology">토폴로지</a><button aria-label="접을 수 있는 사이드바 분류 &#x27;토폴로지&#x27; 접기(펼치기)" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/java/track-transactions-intro">트랜잭션</a><button aria-label="접을 수 있는 사이드바 분류 &#x27;트랜잭션&#x27; 접기(펼치기)" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/java/metrics-intro">메트릭스</a><button aria-label="접을 수 있는 사이드바 분류 &#x27;메트릭스&#x27; 접기(펼치기)" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/java/analysis-report-intro">분석과 통계</a><button aria-label="접을 수 있는 사이드바 분류 &#x27;분석과 통계&#x27; 접기(펼치기)" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/java/apm-set-notice">알림 설정하기</a><button aria-label="접을 수 있는 사이드바 분류 &#x27;알림 설정하기&#x27; 접기(펼치기)" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/log/introduction">Log 모니터링</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/apidoc/openapi-intro">Open API</a></li></ul></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Alpn" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="홈" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_SLhD"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/java/introduction"><span itemprop="name">JAVA 모니터링</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/java/set-agent"><span itemprop="name">설정하기</span></a><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">에이전트 플러그인</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">스크립트 플러그인</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">이 페이지에서</button></div><div class="theme-doc-markdown markdown"><header><h1>스크립트 플러그인</h1></header><p>Java 에이전트에서 제공하는 플러그인을 활용해 트레이스 데이터에 부가 정보를 추가하거나, 메소드 수행 전/후로 원하는 코드를 주입하는 것과 같은 다양한 일을 할 수 있습니다.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="플러그인-옵션">플러그인 옵션<a href="#플러그인-옵션" class="hash-link" aria-label="제목으로 바로 가기" title="제목으로 바로 가기">​</a></h2><p>Java 에이전트 플러그인은 메소드 시작/종료 부분에 삽입해 실행합니다. 플러그인을 적용할 위치(클래스, 메소드)는 에이전트 옵션으로 설정할 수 있습니다.</p><ul><li><p><code>hook_trace_helper_start_patterns</code></p><p>메소드 시작 부분에 트레이스 플러그인을 삽입할 지점(클래스, 메소드)을 설정합니다. 플러그인 코드는 <em><code>$WHATAP_HOME</code>/plugin/TraceHelperStart.x</em> 파일에 작성하세요.</p></li><li><p><code>hook_trace_helper_end_patterns</code></p><p>메소드 종료 부분에 트레이스 플러그인을 삽입할 지점(클래스, 메소드)를 설정합니다. 플러그인 코드는 <em><code>$WHATAP_HOME</code>/plugin/TraceHelperEnd.x</em> 파일에 작성하세요.</p></li><li><p><code>hook_trace_helper_patterns</code></p><p>메소드 시작/종료 양쪽에 트레이스 플러그인을 삽입할 지점(클래스, 메소드)을 설정합니다. 플러그인 코드는 <em><code>$WHATAP_HOME</code>/plugin/TraceHelperStart.x</em>, <em><code>$WHATAP_HOME</code>/plugin/TraceHelperEnd.x</em> 파일에 각각 작성하세요.</p></li><li><p><code>custom_pool_classes</code></p><p>사용자 정의 pool을 모니터링 하기 위해 pool 사용량 정보를 가진 클래스를 설정합니다. 플러그인 코드는 <em><code>$/WHATAP_HOME</code>/plugin/CustomPool.x</em>에 작성합니다.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="플러그인-설정-예시">플러그인 설정 예시<a href="#플러그인-설정-예시" class="hash-link" aria-label="제목으로 바로 가기" title="제목으로 바로 가기">​</a></h2><p>여러 개의 클래스를 설정하는 경우 쉼표(,)를 구분자로 이용하세요. 패키지 이름의 문자열 일부 혹은 전부를 &#x27;*&#x27;로 치환할 수 있습니다.</p><ul><li><p><strong>패키지와 메소드 이름을 설정하는 경우</strong></p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token class-name namespace">whatap</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name namespace">bytecode</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name namespace">instrument</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name">PluginTestA</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">testA</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token class-name namespace">whatap</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name namespace">bytecode</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name namespace">instrument</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name">PluginTestB</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">testB</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p><strong>패키지와 메소드 이름을 *로 치환하는 경우</strong></p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">*</span><span class="token class-name">PluginTestA</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">testA</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token class-name namespace">whatap</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name namespace">bytecode</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name namespace">instrument</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name">PluginTestB</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">*</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">testA</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">*</span><span class="token class-name">PluginTestB</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">testB</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p><strong>전체를 대상으로 하는 경우</strong></p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">*</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p><strong>Custom Pool을 설정하는 경우</strong></p><p>Custom Pool은 식별자@패키지 명 형태로 설정합니다.<br>
<!-- -->예시, Class 명 앞에 <code>whatap_plugin_guide</code>라는 식별자를 설정니다. 식별자와 클래스는 @로 구분합니다.</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">whatap_plugin_guide</span><span class="token annotation punctuation" style="color:rgb(248, 248, 242)">@com.ibm.ws.connectionpool.monitor.ConnectionPoolStats</span><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="플러그인-코드-작성-예시">플러그인 코드 작성 예시<a href="#플러그인-코드-작성-예시" class="hash-link" aria-label="제목으로 바로 가기" title="제목으로 바로 가기">​</a></h2><p>대부분의 경우 오브젝트를 반환하므로 명시적 type casting 처리가 필요합니다. 다음은 플러그인 코드 작성 예시입니다.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="설정한-메소드-시작-시간을-트레이스에-기록하기">설정한 메소드 시작 시간을 트레이스에 기록하기<a href="#설정한-메소드-시작-시간을-트레이스에-기록하기" class="hash-link" aria-label="제목으로 바로 가기" title="제목으로 바로 가기">​</a></h3><ol><li><p>Java 에이전트 <code>hook_trace_helper_patterns</code> 옵션에 적용할 메소드를 <em>whatap.conf</em> 파일에 작성하세요.</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_Ktv7">$WHATAP_HOME/whatap.conf</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key attr-name" style="color:rgb(241, 250, 140)">hook_trace_helper_patterns</span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token value attr-value">org.apache.catalina.connector.RequestFacade.*</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p><em>TraceHelperStart.x</em> 파일에 플러그인 코드를 작성하세요.</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_Ktv7">$WHATAP_HOME/plugin/TraceHelperStart.x</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">// String prefix에 클래스명, 메소드명을 대입하세요.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token class-name">String</span><span class="token plain"> prefix </span><span class="token operator">=</span><span class="token plain"> $point</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">class1 </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;.&quot;</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> $point</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">method</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// 와탭 트레이스 속성 명칭을 `prefix` + &quot;st&quot; 로 현재 시간을 설정하세요.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">setAttribute</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">prefix </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;st&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">Long</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token class-name">System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">currentTimeMillis</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// 트레이스 정보에 현재 시간을 추가하세요.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">profile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">prefix </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot; Start&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name namespace">java</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name namespace">util</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name">Date</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">toString</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol><p>트레이스 내역에 메소드 시작시간을 다음과 같이 표시합니다.</p><p><img loading="lazy" alt="시작 시간을 기록한 트레이스 내역" src="/assets/images/java-script-plugin-1-f799ac50d84e46a2190cb994e2d6fcf9.png" width="456" height="98" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="설정한-메소드-종료시간과-수행시간을-트레이스에-기록하기">설정한 메소드 종료시간과 수행시간을 트레이스에 기록하기<a href="#설정한-메소드-종료시간과-수행시간을-트레이스에-기록하기" class="hash-link" aria-label="제목으로 바로 가기" title="제목으로 바로 가기">​</a></h3><ol><li><p>Java 에이전트 <code>hook_trace_helper_patterns</code> 옵션에 적용할 메소드를 <em>whatap.conf</em> 파일에 작성하세요.</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_Ktv7">$WHATAP_HOME/whatap.conf</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key attr-name" style="color:rgb(241, 250, 140)">hook_trace_helper_patterns</span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token value attr-value">org.apache.catalina.connector.RequestFacade.*</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p><em>TraceHelperEnd.x</em> 파일에 플러그인 코드를 작성하세요.</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_Ktv7">$WHATAP_HOME/plugin/TraceHelperEnd.x</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token class-name">String</span><span class="token plain"> prefix </span><span class="token operator">=</span><span class="token plain"> $point</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">class1 </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;.&quot;</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> $point</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">method</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// TraceHelperStart.x 파일에서 추가한 트레이스 속성을 가져오세요.</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">long</span><span class="token plain"> st </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token class-name">Long</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> $ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">getAttribute</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">prefix </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;st&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">longValue</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">long</span><span class="token plain"> gap </span><span class="token operator">=</span><span class="token plain"> </span><span class="token class-name">System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">currentTimeMillis</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">-</span><span class="token plain"> st</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token class-name">StringBuilder</span><span class="token plain"> sb </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">StringBuilder</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">append</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name namespace">java</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name namespace">util</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name">Date</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">toString</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot; (Gap:&quot;</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> gap </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot; milliseconds)&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// 트레이스 정보에 시작 시간과의 현재 시간과의 Gap(수행시간)을 추가하세요.</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">$ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">profile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">prefix </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot; End&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> sb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">toString</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol><p>트레이스 내역에 메소드 종료시간과 수행시간을 다음과 같이 표시합니다.</p><p><img loading="lazy" alt="종료 / 수행시간 까지 기록된 트레이스 내역" src="/assets/images/java-script-plugin-2-f799ac50d84e46a2190cb994e2d6fcf9.png" width="456" height="98" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="플러그인-api">플러그인 API<a href="#플러그인-api" class="hash-link" aria-label="제목으로 바로 가기" title="제목으로 바로 가기">​</a></h2><p>플러그인 API는 공통 항목인 <code>$ctx</code>, <code>$point</code>, <code>$req</code>, <code>$res</code>로 구분합니다. 트랜잭션 시작/종료시, HTTPC 구간, 특정 메소드 실행 구간 등에 적용할 수 있습니다.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="common-plugin">파라미터 제공 - 공통 플러그인 파일<a href="#common-plugin" class="hash-link" aria-label="제목으로 바로 가기" title="제목으로 바로 가기">​</a></h3><table><thead><tr><th align="center">파라미터</th><th>메소드/변수</th><th>설명</th></tr></thead><tbody><tr><td align="center" rowspan="22">$ctx</td><td>속성관리</td><td></td></tr><tr><td>void setAttribute(String key, Object value)</td><td>Attribute를 설정합니다.</td></tr><tr><td>Object getAttribute(String key)</td><td>Attribute의 값을 가져옵니다.</td></tr><tr><td colspan="2">트레이스 데이터</td></tr><tr><td>void profile(String desc)</td><td>트레이스 메시지 기록</td></tr><tr><td>void profile(String name, String msg)</td><td>트레이스 Step명, 메시지 기록</td></tr><tr><td>void profile(String name, String msg, int elapsed)</td><td>트레이스 Step명, 메시지, 수행시간 기록</td></tr><tr><td>void profile(String name, String msg, int elapsed, int value)</td><td>트레이스 Step명, 메시지, 수행시간, 순서 기록</td></tr><tr><td colspan="2">HTTP Request</td></tr><tr><td>String service()</td><td>서비스 이름 반환</td></tr><tr><td>void service(String name)</td><td>서비스 이름 설정</td></tr><tr><td>int serviceHash()</td><td>서비스이름의 Hash값 반환</td></tr><tr><td>String remoteIp()</td><td>서비스 요청 IP 반환</td></tr><tr><td>void remoteIp(String ip)</td><td>서비스 요청 IP 설정</td></tr><tr><td>boolean isError()</td><td>에러 여부 반환</td></tr><tr><td>void login(String id)</td><td>로그인 ID 설정</td></tr><tr><td>String login()</td><td>로그인 ID 반환</td></tr><tr><td>String httpMethod()</td><td>HTTP Method 반환</td></tr><tr><td>String httpQuery()</td><td>HTTP Query 반환</td></tr><tr><td>String httpContentType()</td><td>HTTP ContentType 반환</td></tr><tr><td>String userAgent()</td><td>User-Agent 반환</td></tr><tr><td>int status()</td><td>HTTP status 반환</td></tr><tr><td align="center" rowspan="5">$point</td><td>String class1</td><td>클래스명</td></tr><tr><td>String method</td><td>메소드명</td></tr><tr><td>Object this1</td><td>Hooking 대상 클래스/메소드</td></tr><tr><td>Object[] args</td><td>인자</td></tr><tr><td>Object return1</td><td>리턴</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="파라미터-미제공---공통-플러그인-파일">파라미터 미제공 - 공통 플러그인 파일<a href="#파라미터-미제공---공통-플러그인-파일" class="hash-link" aria-label="제목으로 바로 가기" title="제목으로 바로 가기">​</a></h3><table><thead><tr><th align="center">파라미터</th><th>메소드/변수</th><th>설명</th></tr></thead><tbody><tr><td align="center" rowspan="18">없음</td><td>void log(Object c)</td><td>Logger를 통한 Logging</td></tr><tr><td>void println(Object c)</td><td>System.out.println() 을 통한 출력</td></tr><tr><td>Object field(Object o, String field)</td><td>Field 값 반환</td></tr><tr><td>Object method(Object o, String method)</td><td>Invoke 메소드</td></tr><tr><td>Object method(Object o, String method, String param)</td><td>Invoke 메소드</td></tr><tr><td>String toString(Object o)</td><td>Object를 toSting() 반환</td></tr><tr><td>String toString(Object o, String def)</td><td>Object를 toSting() 반환, null 인경우 def 반환</td></tr><tr><td>int syshash(Object o)</td><td>hash 값 반환</td></tr><tr><td>int syshash(HookArgs hook, int x)</td><td>x 번째 argument의 hash 값 반환</td></tr><tr><td>int syshash(HookArgs hook)</td><td>argument의 hash 값 반환</td></tr><tr><td>int cint(Object o)</td><td>int로 반환</td></tr><tr><td>float cfloat(Object o)</td><td>float 으로 반환</td></tr><tr><td>String cString(Object o)</td><td>String 으로 반환</td></tr><tr><td>long clong(Object o)</td><td>long으로 반환</td></tr><tr><td>double cdouble(Object o)</td><td>double로 반환</td></tr><tr><td>String desc(Object o)</td><td>Class signature 반환</td></tr><tr><td>String toJson(Object o)</td><td>json으로 반환</td></tr><tr><td>void shell(final String cmd, final String env)</td><td>shell 실행</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="데몬-및-배치">데몬 및 배치<a href="#데몬-및-배치" class="hash-link" aria-label="제목으로 바로 가기" title="제목으로 바로 가기">​</a></h3><p>데몬, 배치와 같은 애플리케이션 서버를 모니터링할 때 시작점으로 설정한 메소드에 적용하는 API입니다. 다음 파일에 코드를 작성하세요.</p><ul><li>서비스 시작 부분 적용: <em><code>$WHATAP_HOME</code>/plugin/AppServiceStart.x</em></li><li>서비스 종료 부분 적용: <em><code>$WHATAP_HOME</code>/plugin/AppServiceEnd.x</em></li></ul><table><thead><tr><th>플러그인 파일</th><th align="center">파라미터</th><th>메소드/변수</th><th>설명</th></tr></thead><tbody><tr><td rowspan="2">AppServiceStart.x</td><td align="center">$ctx</td><td colspan="2">공통 속성 참조</td></tr><tr><td align="center">$point</td><td colspan="2">공통 속성 참조</td></tr><tr><td>AppServiceEnd.x</td><td align="center">$ctx</td><td colspan="2">공통 속성 참조</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="http-서비스">HTTP 서비스<a href="#http-서비스" class="hash-link" aria-label="제목으로 바로 가기" title="제목으로 바로 가기">​</a></h3><p><code>javax.servlet.http.HTTPServlet</code> 클래스를 사용하는 일반적인 웹 애플리케이션에 적용할 수 있는 API입니다. 다음 파일에 코드를 작성하세요.</p><ul><li>서비스 시작 부분 적용: <em><code>$WHATAP_HOME</code>/plugin/HttpServiceStart.x</em></li><li>서비스 종료 부분 적용: <em><code>$WHATAP_HOME</code>/plugin/HttpServiceEnd.x</em> </li></ul><table><thead><tr><th>플러그인 파일</th><th align="center">파라미터</th><th>메소드/변수</th><th>설명</th></tr></thead><tbody><tr><td rowspan="20">HttpServiceStart.x/<br>HttpServiceEnd.x</td><td align="center">$ctx</td><td colspan="2">공통 속성 참조</td></tr><tr><td align="center" rowspan="15">$req</td><td>String getCookie(String key)</td><td>Cookie 값 반환</td></tr><tr><td>String getRequestURI()</td><td>RequestURI 반환</td></tr><tr><td>String getRemoteAddr()</td><td>RemoteAddr 반환</td></tr><tr><td>String getMethod()</td><td>HTTP Method 반환</td></tr><tr><td>String getQueryString()</td><td>HTTP QueryString 반환</td></tr><tr><td>String getParameter(String key)</td><td>Parameter 값 반환</td></tr><tr><td>Object getAttribute(String key)</td><td>Attribute 값 반환</td></tr><tr><td>String getHeader(String key)</td><td>Header 값 반환</td></tr><tr><td>Enumeration getParameterNames()</td><td>getParameterNames 반환</td></tr><tr><td>Enumeration getHeaderNames()</td><td>getHeaderNames 반환</td></tr><tr><td>WrSession getSession()</td><td>Session Wrapper 반환</td></tr><tr><td>Set getSessionNames()</td><td>getSessionNames 반환</td></tr><tr><td>Object getSessionAttribute(String key)</td><td>getSessionAttribute 반환</td></tr><tr><td>boolean isOk()</td><td>Plugin 상태 반환</td></tr><tr><td>Throwable error()</td><td>Error 반환</td></tr><tr><td align="center" rowspan="4">$res</td><td>String getContentType()</td><td>ContentType 반환</td></tr><tr><td>String getCharacterEncoding()</td><td>CharacterEncoding 반환</td></tr><tr><td>boolean isOk()</td><td>Plugin 상태 반환</td></tr><tr><td>Throwable error()</td><td>Error 반환</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="http-outbound">HTTP Outbound<a href="#http-outbound" class="hash-link" aria-label="제목으로 바로 가기" title="제목으로 바로 가기">​</a></h3><p><code>HttpClient</code>와 같은 라이브러리를 이용해 HTTP Outbound Call 수행 할 때 적용할 수 있는 API입니다. 다음 파일에 코드를 작성하세요.</p><ul><li>서비스 시작 부분 적용: <em><code>$WHATAP_HOME</code>/plugin/HttpCallStart.x</em></li><li>서비스 종료 부분 적용: <em><code>$WHATAP_HOME</code>/plugin/HttpCallEnd.x</em></li></ul><table><thead><tr><th>플러그인 파일</th><th align="center">파라미터</th><th>메소드/변수</th><th>설명</th></tr></thead><tbody><tr><td rowspan="6">HttpCallStart.x</td><td align="center">$ctx</td><td colspan="2">공통 속성 참조</td></tr><tr><td align="center" rowspan="5">$req</td><td>String url()</td><td>URL 반환</td></tr><tr><td>String host()</td><td>Hostname 반환</td></tr><tr><td>int port()</td><td>Port 반환</td></tr><tr><td>boolean isOk()</td><td>Plugin 상태 반환</td></tr><tr><td>Throwable error()</td><td>Error 반환</td></tr><tr><td rowspan="5">HttpCallEnd.x</td><td align="center">$ctx</td><td colspan="2">공통 속성 참조</td></tr><tr><td align="center" rowspan="4">$res</td><td>String getContentType()</td><td>ContentType 반환</td></tr><tr><td>String getCharacterEncoding()</td><td>CharacterEncoding 반환</td></tr><tr><td>boolean isOk()</td><td>Plugin 상태 반환</td></tr><tr><td>Throwable error()</td><td>Error 반환</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="특정-메소드">특정 메소드<a href="#특정-메소드" class="hash-link" aria-label="제목으로 바로 가기" title="제목으로 바로 가기">​</a></h3><p>자바 에이전트 옵션(<code>hook_trace_helper_*</code>)을 통해 설정한 메소드에 대해 적용하는 API 입니다.</p><table><thead><tr><th>플러그인 파일</th><th align="center">파라미터</th><th>메소드/변수</th><th>설명</th></tr></thead><tbody><tr><td rowspan="2">TraceHelperStart.x</td><td align="center">$ctx</td><td colspan="2">공통 속성 참조</td></tr><tr><td align="center">$point</td><td colspan="2">공통 속성 참조</td></tr><tr><td rowspan="2">TraceHelperEnd.x</td><td align="center">$ctx</td><td colspan="2">공통 속성 참조</td></tr><tr><td align="center">$point</td><td colspan="2">공통 속성 참조</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="사용자-정의-pool">사용자 정의 Pool<a href="#사용자-정의-pool" class="hash-link" aria-label="제목으로 바로 가기" title="제목으로 바로 가기">​</a></h3><p>사용자 정의 Pool을 모니터링 하기 위한 API입니다. Pool 사용량 정보를 가진 메소드를 설정하면 와탭 모니터링 서비스에서 관찰하고 통계 정보를 확인할 수 있습니다.</p><table><thead><tr><th>플러그인 파일</th><th align="center">파라미터</th><th>메소드/변수</th><th>설명</th></tr></thead><tbody><tr><td rowspan="4">CustomPool.x</td><td align="center">$id</td><td colspan="2">custom_pool_classes에 설정한 id 값</td></tr><tr><td align="center">$pool</td><td colspan="2">custom_pool_classes에 설정한 class</td></tr><tr><td align="center" rowspan="2">$result</td><td>active(Object o)</td><td>Active Pool Count 설정</td></tr><tr><td>int idle(Object o)</td><td>Idle Pool Count 설정</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="플러그인-적용-사례">플러그인 적용 사례<a href="#플러그인-적용-사례" class="hash-link" aria-label="제목으로 바로 가기" title="제목으로 바로 가기">​</a></h2><p>다음은 실제 플러그인 적용 사례입니다.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="elasticsearch-엔진의-검색-요청-모니터링">Elasticsearch 엔진의 검색 요청 모니터링<a href="#elasticsearch-엔진의-검색-요청-모니터링" class="hash-link" aria-label="제목으로 바로 가기" title="제목으로 바로 가기">​</a></h3><p>Elasticsearch(이하 ES) 엔진은 서블릿 엔진이 아니기 때문에 비정형 모니터링을 해야 합니다. 타상품이 지표 중심의 모니터링을 한다면 와탭의 플러그인을 활용해 ES의 요청 및 처리시간, 검색 키워드를 트레이싱할 수 있습니다.</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_Ktv7">whatap.conf</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># 트랜잭션 EndPoint로 org.elasticsearch.search.SearchService.executeQueryPhase를 설정합니다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key attr-name" style="color:rgb(241, 250, 140)">hook_service_patterns</span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token value attr-value">org.elasticsearch.search.SearchService.executeQueryPhase</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># hook_trace_helper_start_patterns에 등록된 메소드가 실행될 때마다 TraceHelperStart.x 파일의 코드를 실행합니다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key attr-name" style="color:rgb(241, 250, 140)">hook_trace_helper_start_patterns</span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token value attr-value">org.elasticsearch.search.query.QueryPhase.execute</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_Ktv7">${WHATAP_HOME}/plugin/TraceHelperStart.x</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">$ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">inner</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">==</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">null</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">try</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token class-name">String</span><span class="token plain"> tclass </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;org.elasticsearch.search.query.QueryPhase&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token class-name">String</span><span class="token plain"> tmethod </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;execute&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">tclass</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">equals</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">$point</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">class1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&amp;&amp;</span><span class="token plain"> tmethod</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">equals</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">$point</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">method</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)">// 첫번째 argument의 query 메소드 호출 결과를 String query에 저장,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)">// org.elasticsearch.search.query.QueryPhase.execute(SearchContext searchContext)입니다.</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)">// 즉, SearchContext.query() 메소드를 invoke 한 결과를 String query에 저장합니다.</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token class-name">String</span><span class="token plain"> query </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot; &quot;</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">method</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">$point</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">args</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;query&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)">// String query를 트레이스 정보로 출력</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        $ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">profile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">query</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">catch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token class-name">Exception</span><span class="token plain"> e</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    $ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">profile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">toString</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="특정-ip로-유입되는-트랜잭션-수집-제외">특정 IP로 유입되는 트랜잭션 수집 제외<a href="#특정-ip로-유입되는-트랜잭션-수집-제외" class="hash-link" aria-label="제목으로 바로 가기" title="제목으로 바로 가기">​</a></h3><p>Health Check, 내부 사용자들이 유발한 트랜잭션을 수집 제외하려면 플러그인을 활용할 수 있습니다.</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_Ktv7">${WHATAP_HOME}/plugin/HttpServiceStart.x</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:rgb(98, 114, 164)">// ignoreIP 값을 수집 제외할 IP로 설정하세요.</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token class-name">String</span><span class="token plain"> ignoreIP </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;123.234.123.234&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token class-name">String</span><span class="token plain"> remoteIP </span><span class="token operator">=</span><span class="token plain"> $req</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">getRemoteAddr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">$ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">ok</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&amp;&amp;</span><span class="token plain"> remoteIP </span><span class="token operator">!=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">null</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">remoteIP</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">equals</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ignoreIP</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        $ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">ignore</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="atomikos-pool-모니터링">Atomikos Pool 모니터링<a href="#atomikos-pool-모니터링" class="hash-link" aria-label="제목으로 바로 가기" title="제목으로 바로 가기">​</a></h3><p><a href="https://www.atomikos.com/downloads/transactions-essentials/com/atomikos/AtomikosTransactionsEssentials/javadoc/3.7/com/atomikos/jdbc/AbstractDataSourceBean.html" target="_blank" rel="noopener noreferrer">API 문서</a>를 참고해 적용하세요.</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_Ktv7">whatap.conf</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key attr-name" style="color:rgb(241, 250, 140)">custom_pool_classes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token value attr-value">atomikos@com.atomikos.jdbc.internal.AbstractDataSourceBean</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_Ktv7">${WHATAP_HOME}/plugin/CustomPool.x</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> total </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">cint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token function" style="color:rgb(80, 250, 123)">method</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">$pool</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;poolTotalSize&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> avail </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">cint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token function" style="color:rgb(80, 250, 123)">method</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">$pool</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;poolAvailableSize&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$result</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">active</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">total </span><span class="token operator">-</span><span class="token plain"> avail</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$result</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">idle</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">avail</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="트레이스에-cookie-값-표현">트레이스에 Cookie 값 표현<a href="#트레이스에-cookie-값-표현" class="hash-link" aria-label="제목으로 바로 가기" title="제목으로 바로 가기">​</a></h3><p>쿠키값을 트레이스에서 확인할 수 있습니다.</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_Ktv7">${WHATAP_HOME}/plugin/HttpServiceStart.x</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:rgb(98, 114, 164)">// $req.getCookie() 파라미터로 확인하려는 Cookie를 설정하세요.</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token class-name">String</span><span class="token plain"> cookie </span><span class="token operator">=</span><span class="token plain"> $req</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">getCookie</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;AWSALB&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">$ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">ok</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">cookie </span><span class="token operator">!=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">null</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        $ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">profile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">cookie</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>태그:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/java">Java</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/script-plugin">Script plugin</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="문서 탐색"><a class="pagination-nav__link pagination-nav__link--prev" href="/java/agent-httpcapicall"><div class="pagination-nav__sublabel">이전</div><div class="pagination-nav__label">HTTPC, API Call</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/java/weaving-plugin"><div class="pagination-nav__sublabel">다음</div><div class="pagination-nav__label">위빙 플러그인</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#플러그인-옵션" class="table-of-contents__link toc-highlight">플러그인 옵션</a></li><li><a href="#플러그인-설정-예시" class="table-of-contents__link toc-highlight">플러그인 설정 예시</a></li><li><a href="#플러그인-코드-작성-예시" class="table-of-contents__link toc-highlight">플러그인 코드 작성 예시</a><ul><li><a href="#설정한-메소드-시작-시간을-트레이스에-기록하기" class="table-of-contents__link toc-highlight">설정한 메소드 시작 시간을 트레이스에 기록하기</a></li><li><a href="#설정한-메소드-종료시간과-수행시간을-트레이스에-기록하기" class="table-of-contents__link toc-highlight">설정한 메소드 종료시간과 수행시간을 트레이스에 기록하기</a></li></ul></li><li><a href="#플러그인-api" class="table-of-contents__link toc-highlight">플러그인 API</a><ul><li><a href="#common-plugin" class="table-of-contents__link toc-highlight">파라미터 제공 - 공통 플러그인 파일</a></li><li><a href="#파라미터-미제공---공통-플러그인-파일" class="table-of-contents__link toc-highlight">파라미터 미제공 - 공통 플러그인 파일</a></li><li><a href="#데몬-및-배치" class="table-of-contents__link toc-highlight">데몬 및 배치</a></li><li><a href="#http-서비스" class="table-of-contents__link toc-highlight">HTTP 서비스</a></li><li><a href="#http-outbound" class="table-of-contents__link toc-highlight">HTTP Outbound</a></li><li><a href="#특정-메소드" class="table-of-contents__link toc-highlight">특정 메소드</a></li><li><a href="#사용자-정의-pool" class="table-of-contents__link toc-highlight">사용자 정의 Pool</a></li></ul></li><li><a href="#플러그인-적용-사례" class="table-of-contents__link toc-highlight">플러그인 적용 사례</a><ul><li><a href="#elasticsearch-엔진의-검색-요청-모니터링" class="table-of-contents__link toc-highlight">Elasticsearch 엔진의 검색 요청 모니터링</a></li><li><a href="#특정-ip로-유입되는-트랜잭션-수집-제외" class="table-of-contents__link toc-highlight">특정 IP로 유입되는 트랜잭션 수집 제외</a></li><li><a href="#atomikos-pool-모니터링" class="table-of-contents__link toc-highlight">Atomikos Pool 모니터링</a></li><li><a href="#트레이스에-cookie-값-표현" class="table-of-contents__link toc-highlight">트레이스에 Cookie 값 표현</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 WhaTap Labs Inc. All right reserved. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.5f3bfd9f.js"></script>
<script src="/assets/js/main.70a14a28.js"></script>
</body>
</html>